<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Viewer with PDF.js</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            overflow: hidden;
        }

        .pdf-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .toolbar {
            background-color: #333;
            color: white;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .toolbar button {
            padding: 8px 15px;
            background-color: #555;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .toolbar button:hover {
            background-color: #666;
        }

        .toolbar button:disabled {
            background-color: #444;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .toolbar input {
            padding: 8px;
            border: none;
            border-radius: 4px;
            width: 60px;
            text-align: center;
        }

        .toolbar select {
            padding: 8px;
            border: none;
            border-radius: 4px;
            background-color: #555;
            color: white;
            cursor: pointer;
        }

        .page-info {
            margin: 0 10px;
        }

        .viewer-container {
            flex: 1;
            overflow: auto;
            background-color: #e0e0e0;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
        }

        .page-wrapper {
            position: relative;
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transform-origin: center center;
            transition: transform 0.6s ease-in-out;
            transform-style: preserve-3d;
        }

        .page-wrapper.flipping-next {
            animation: flipNext 0.6s ease-in-out;
        }

        .page-wrapper.flipping-prev {
            animation: flipPrev 0.6s ease-in-out;
        }

        @keyframes flipNext {
            0% {
                transform: rotateY(0deg);
            }

            50% {
                transform: rotateY(-90deg);
            }

            100% {
                transform: rotateY(0deg);
            }
        }

        @keyframes flipPrev {
            0% {
                transform: rotateY(0deg);
            }

            50% {
                transform: rotateY(90deg);
            }

            100% {
                transform: rotateY(0deg);
            }
        }

        canvas {
            display: block;
            max-width: 100%;
            height: auto;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            color: #666;
        }

        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .zoom-level {
            min-width: 60px;
            text-align: center;
        }

        .pdf-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .error-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #f44336;
            color: white;
            padding: 20px;
            border-radius: 4px;
            display: none;
        }
    </style>
</head>

<body>
    <div class="pdf-container">
        <div class="toolbar">
            <button id="prevPage" onclick="previousPage()">← Previous</button>
            <button id="nextPage" onclick="nextPage()">Next →</button>

            <div class="page-info">
                <input type="number" id="pageNum" min="1" onchange="goToPage(this.value)">
                <span> / <span id="totalPages">0</span></span>
            </div>

            <div class="zoom-controls">
                <button onclick="zoomOut()">Zoom Out</button>
                <select id="zoomSelect" onchange="setZoom(this.value)">
                    <option value="0.5">50%</option>
                    <option value="0.75">75%</option>
                    <option value="1" selected>100%</option>
                    <option value="1.25">125%</option>
                    <option value="1.5">150%</option>
                    <option value="2">200%</option>
                    <option value="3">300%</option>
                </select>
                <button onclick="zoomIn()">Zoom In</button>
            </div>

            <!-- Optional: Add a dropdown to select different PDFs -->
            <div class="pdf-selector">
                <label for="pdfSelect">Document:</label>
                <select id="pdfSelect" onchange="loadSelectedPDF(this.value)">
                    <option value="document1.pdf">Document 1</option>
                    <option value="document2.pdf">Document 2</option>
                    <option value="subfolder/document3.pdf">Document 3</option>
                </select>
            </div>
        </div>

        <div class="viewer-container" id="viewerContainer">
            <div class="page-wrapper" id="pageWrapper">
                <canvas id="pdfCanvas"></canvas>
            </div>
            <div class="loading" id="loading" style="display: none;">Loading...</div>
            <div class="error-message" id="errorMessage"></div>
        </div>
    </div>

    <script>
        // Set worker source
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // Configuration - Set your static PDF path here
        const PDF_BASE_PATH = '/downloads'; // Change this to your PDF folder path
        const DEFAULT_PDF = '/google-file-system.pdf'; // Default PDF file to load

        let pdfDoc = null;
        let currentPage = 1;
        let pageRendering = false;
        let pageNumPending = null;
        let scale = 1;
        let canvas = document.getElementById('pdfCanvas');
        let ctx = canvas.getContext('2d');

        // Load default PDF on page load
        window.onload = function () {
            loadPDFFromPath(DEFAULT_PDF);
        };

        function loadPDFFromPath(filename) {
            const pdfPath = PDF_BASE_PATH + filename;
            document.getElementById('loading').style.display = 'block';
            document.getElementById('errorMessage').style.display = 'none';

            // Reset page number when loading new PDF
            currentPage = 1;

            pdfjsLib.getDocument(pdfPath).promise.then(function (pdf) {
                pdfDoc = pdf;
                document.getElementById('totalPages').textContent = pdf.numPages;
                document.getElementById('pageNum').max = pdf.numPages;
                document.getElementById('pageNum').value = 1;
                renderPage(currentPage);
            }).catch(function (error) {
                console.error('Error loading PDF:', error);
                document.getElementById('loading').style.display = 'none';
                showError(`Failed to load PDF: ${filename}. Please ensure the file exists at ${pdfPath}`);
            });
        }

        function loadSelectedPDF(filename) {
            if (filename) {
                loadPDFFromPath(filename);
            }
        }

        function showError(message) {
            const errorElement = document.getElementById('errorMessage');
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }

        function renderPage(num) {
            pageRendering = true;
            document.getElementById('loading').style.display = 'block';

            pdfDoc.getPage(num).then(function (page) {
                const viewport = page.getViewport({ scale: scale });
                canvas.height = viewport.height;
                canvas.width = viewport.width;

                const renderContext = {
                    canvasContext: ctx,
                    viewport: viewport
                };

                const renderTask = page.render(renderContext);

                renderTask.promise.then(function () {
                    pageRendering = false;
                    document.getElementById('loading').style.display = 'none';

                    if (pageNumPending !== null) {
                        renderPage(pageNumPending);
                        pageNumPending = null;
                    }
                });
            });

            // Update UI
            document.getElementById('pageNum').value = num;
            document.getElementById('prevPage').disabled = (num <= 1);
            document.getElementById('nextPage').disabled = (num >= pdfDoc.numPages);
        }

        function queueRenderPage(num) {
            if (pageRendering) {
                pageNumPending = num;
            } else {
                renderPage(num);
            }
        }

        function previousPage() {
            if (currentPage <= 1) return;

            const wrapper = document.getElementById('pageWrapper');
            wrapper.classList.add('flipping-prev');

            setTimeout(() => {
                currentPage--;
                queueRenderPage(currentPage);
                wrapper.classList.remove('flipping-prev');
            }, 300);
        }

        function nextPage() {
            if (currentPage >= pdfDoc.numPages) return;

            const wrapper = document.getElementById('pageWrapper');
            wrapper.classList.add('flipping-next');

            setTimeout(() => {
                currentPage++;
                queueRenderPage(currentPage);
                wrapper.classList.remove('flipping-next');
            }, 300);
        }

        function goToPage(pageNumber) {
            const num = parseInt(pageNumber);
            if (num < 1 || num > pdfDoc.numPages || isNaN(num)) {
                document.getElementById('pageNum').value = currentPage;
                return;
            }

            if (num === currentPage) return;

            const wrapper = document.getElementById('pageWrapper');
            if (num > currentPage) {
                wrapper.classList.add('flipping-next');
            } else {
                wrapper.classList.add('flipping-prev');
            }

            setTimeout(() => {
                currentPage = num;
                queueRenderPage(currentPage);
                wrapper.classList.remove('flipping-next', 'flipping-prev');
            }, 300);
        }

        function setZoom(zoomValue) {
            scale = parseFloat(zoomValue);
            if (pdfDoc) {
                queueRenderPage(currentPage);
            }
        }

        function zoomIn() {
            if (scale < 3) {
                scale = Math.min(scale + 0.25, 3);
                document.getElementById('zoomSelect').value = scale;
                if (pdfDoc) {
                    queueRenderPage(currentPage);
                }
            }
        }

        function zoomOut() {
            if (scale > 0.5) {
                scale = Math.max(scale - 0.25, 0.5);
                document.getElementById('zoomSelect').value = scale;
                if (pdfDoc) {
                    queueRenderPage(currentPage);
                }
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function (e) {
            if (!pdfDoc) return;

            switch (e.key) {
                case 'ArrowLeft':
                    previousPage();
                    break;
                case 'ArrowRight':
                    nextPage();
                    break;
                case '+':
                case '=':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        zoomIn();
                    }
                    break;
                case '-':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        zoomOut();
                    }
                    break;
            }
        });

        // Optional: Load PDF from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const pdfParam = urlParams.get('pdf');
        if (pdfParam) {
            loadPDFFromPath(pdfParam);
            // Update dropdown if the PDF is in the list
            const selectElement = document.getElementById('pdfSelect');
            for (let option of selectElement.options) {
                if (option.value === pdfParam) {
                    selectElement.value = pdfParam;
                    break;
                }
            }
        }
    </script>
</body>

</html>